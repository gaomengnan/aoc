* Question

** Closest Pair Sum in an unsorted Array


*** Description
Given an array arr[] and an integer target. You have to find a pair in an array whose sum is closest to target.

Note: Return the pair in sorted order and if there are multiple such pairs return the pair with maximum absolute difference. If no such pair exists return an empty array.

*** Examples
#+begin_example
Input: arr[] = [40, 10, 29, 28, 22, 1, 30], target = 54
Output: [22, 30]
Explanation: The pair 22 and 30 sums to 52 which is the closest sum to 54.
#+end_example

*** Solution

1. 双指针

#+begin_src python
class Solution:
    # Complete the below function
    def closestPairSum(self, arr, target):
        # Your code here
        n = len(arr)

        arr.sort()

        i = 0
        j = n - 1

        minV = float("inf")
        ans = []

        while i < j:
            totalS = arr[i] + arr[j]

            if totalS - target == 0:
                return [arr[i], arr[j]]
            else:
                m1 = abs(totalS - target)
                if m1 < minV:
                    minV = m1
                    ans = [arr[i], arr[j]]
                elif m1 == minV:
                    d1 = abs(ans[0] - ans[1])
                    d2 = abs(arr[i] - arr[j])
                    if d2 > d1:
                        ans = [arr[i], arr[j]]
                else:
                    pass

                if totalS < target:
                    i += 1
                else:
                    j -= 1
        return ans


print(Solution().closestPairSum([40, 10, 29, 28, 22, 1, 30], 54))
print(Solution().closestPairSum([10, 3, 4, 7, 1], 15))

#+end_src
